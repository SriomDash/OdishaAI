<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chakadola Yatra | Odisha Travel Planner</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;500;600&family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --odia-maroon: #6A040F;
            --odia-maroon-light: #9D0208;
            --odia-gold: #FAA307;
            --odia-gold-dim: #D48C00;
            --odia-cream: #FFF8F0;
            --odia-sand: #FFE6A7;
            --text-dark: #2B2118;
            --text-light: #6D5D4B;
            --white: #FFFFFF;
            --shadow-soft: 0 20px 60px -15px rgba(106, 4, 15, 0.2);
            --radius: 20px;
        }

        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--odia-cream);
            background-image: radial-gradient(var(--odia-gold-dim) 0.5px, transparent 0.5px), radial-gradient(var(--odia-gold-dim) 0.5px, var(--odia-cream) 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            display: flex;
            width: 100%;
            max-width: 1100px;
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(250, 163, 7, 0.2);
            animation: slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
        }

        /* --- LOADING OVERLAY STYLES (NEW) --- */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            z-index: 9999;
            display: none; /* Hidden by default */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--odia-cream);
            border-top: 5px solid var(--odia-maroon);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: var(--odia-maroon);
            font-weight: 700;
        }

        .loading-subtext {
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            color: var(--text-light);
            margin-top: 10px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- Sidebar Styling --- */
        .sidebar {
            width: 35%;
            background: linear-gradient(160deg, var(--odia-maroon), var(--odia-maroon-light));
            color: var(--odia-sand);
            padding: 60px 40px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            text-align: center;
            z-index: 1;
            overflow: hidden;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                radial-gradient(circle at 100% 100%, transparent 10px, rgba(255,255,255,0.05) 11px, transparent 12px),
                radial-gradient(circle at 0% 0%, transparent 10px, rgba(255,255,255,0.05) 11px, transparent 12px);
            background-size: 40px 40px;
            opacity: 0.4;
            pointer-events: none;
            z-index: -1;
        }

        .chakra-container {
            position: absolute;
            top: 50%;
            left: -150px;
            width: 500px;
            height: 500px;
            transform: translateY(-50%);
            z-index: 0;
            pointer-events: none;
        }

        .chakra-svg {
            width: 100%;
            height: 100%;
            fill: none;
            stroke: var(--odia-gold);
            stroke-width: 2;
            opacity: 0.15;
            animation: rotateWheel 30s linear infinite;
        }

        @keyframes rotateWheel {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .brand-content {
            z-index: 2;
            width: 100%;
        }

        .brand-content h1 {
            font-family: 'Cinzel', serif;
            font-size: 3rem; 
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 5px;
            color: var(--white);
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
            line-height: 1;
            margin-right: 25px; 
        }

        .odia-script {
            font-family: 'Baloo 2', cursive;
            font-size: 2.2rem;
            color: var(--odia-gold);
            margin-bottom: 20px;
            font-weight: 700;
            opacity: 1;
        }

        .decorative-line {
            height: 3px;
            background: var(--odia-maroon-light);
            box-shadow: 0 1px 0 rgba(255,255,255,0.1);
            margin: 20px auto 40px auto;
            width: 50%;
            opacity: 0.8;
            border-radius: 2px;
        }

        .quote {
            font-family: 'Cinzel', serif;
            font-style: italic;
            font-size: 0.95rem;
            opacity: 0.9;
            margin-top: auto;
            line-height: 1.6;
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background: transparent;
            z-index: 2;
        }

        /* --- Form Section Styling --- */
        .form-section {
            width: 65%;
            padding: 50px 60px;
            overflow-y: auto;
            max-height: 90vh;
            background: var(--white);
        }

        .form-section::-webkit-scrollbar { width: 8px; }
        .form-section::-webkit-scrollbar-track { background: transparent; }
        .form-section::-webkit-scrollbar-thumb { background: #eee; border-radius: 4px; }
        .form-section::-webkit-scrollbar-thumb:hover { background: #ddd; }

        h2 {
            font-family: 'Cinzel', serif;
            color: var(--odia-maroon);
            font-size: 2rem;
            margin-bottom: 35px;
            position: relative;
            display: inline-block;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60%;
            height: 3px;
            background: var(--odia-gold);
            border-radius: 2px;
        }

        .form-group { margin-bottom: 30px; }

        label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: var(--text-light);
            margin-bottom: 12px;
        }

        .required-star {
            color: #D90429;
            font-size: 1.2rem;
            margin-left: 4px;
            line-height: 0;
            vertical-align: middle;
        }

        /* General Input Styles */
        input[type="text"], 
        input[type="number"], 
        input[type="date"], 
        textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #EAEAEA;
            border-radius: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            color: var(--text-dark);
            background: #FAFAFA;
            transition: all 0.3s ease;
        }

        /* Remove Spinners */
        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
        input[type=number] {
          -moz-appearance: textfield;
        }

        input:focus, textarea:focus {
            outline: none;
            background: var(--white);
            border-color: var(--odia-gold);
            box-shadow: 0 4px 15px rgba(250, 163, 7, 0.15);
            transform: translateY(-1px);
        }

        input.input-error {
            border-color: #D90429;
            background: #FFF5F5;
        }

        /* --- TAG INPUT STYLES --- */
        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 8px 12px;
            border: 2px solid #EAEAEA;
            border-radius: 12px;
            background: #FAFAFA;
            min-height: 52px;
            cursor: text;
            transition: all 0.3s ease;
            position: relative;
        }

        .tag-container:focus-within {
            background: var(--white);
            border-color: var(--odia-gold);
            box-shadow: 0 4px 15px rgba(250, 163, 7, 0.15);
        }

        .tag-input {
            flex: 1;
            border: none !important;
            box-shadow: none !important;
            background: transparent !important;
            padding: 5px !important;
            margin: 0 !important;
            min-width: 150px;
        }

        .selected-tag {
            display: flex;
            align-items: center;
            background: var(--odia-maroon);
            color: var(--odia-gold);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            animation: fadeIn 0.2s ease-in;
        }

        .tag-close {
            margin-left: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            line-height: 1;
            color: rgba(255,255,255,0.7);
        }
        .tag-close:hover { color: #fff; }

        .suggestions-list {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
            margin-top: 5px;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.9rem;
        }

        .suggestion-item:hover {
            background: var(--odia-cream);
            color: var(--odia-maroon);
        }

        .suggestion-item strong { color: var(--odia-maroon); }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* --- Range Slider --- */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
            margin: 15px 0 5px 0;
        }
        
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #EAEAEA;
            border-radius: 10px;
            transition: background 0.3s;
        }

        input[type=range]:hover::-webkit-slider-runnable-track { background: #DDD; }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--odia-maroon);
            border: 3px solid var(--white);
            box-shadow: 0 0 0 2px var(--odia-gold), 0 4px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            margin-top: -9px; 
            transition: transform 0.2s;
        }

        input[type=range]:active::-webkit-slider-thumb {
            transform: scale(1.1);
            background: var(--odia-maroon-light);
        }

        .flex-row { display: flex; gap: 15px; }
        .col { flex: 1; }

        .counter-box {
            background: var(--white);
            padding: 8px 10px;
            border-radius: 12px;
            border: 2px solid var(--odia-maroon);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.3s;
        }
        
        .counter-box:focus-within {
            border-color: var(--odia-gold);
            box-shadow: 0 4px 15px rgba(250, 163, 7, 0.15);
        }

        .counter-box input {
            width: 100%;
            text-align: center;
            margin: 0;
            border: none !important;
            background: transparent !important;
            box-shadow: none !important;
            font-weight: 600;
            color: var(--odia-maroon);
            font-size: 1.1rem;
        }

        .chip-container { display: flex; flex-wrap: wrap; gap: 12px; }
        
        .chip {
            padding: 10px 20px;
            border: 1px solid #EAEAEA;
            background: #FAFAFA;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            user-select: none;
        }
        
        .chip:hover {
            transform: translateY(-2px);
            background: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-color: var(--odia-gold);
            color: var(--odia-gold-dim);
        }
        
        .chip.active {
            background: var(--odia-maroon);
            color: var(--odia-sand);
            border-color: var(--odia-maroon);
            box-shadow: 0 5px 15px rgba(106, 4, 15, 0.3);
            transform: translateY(-1px);
        }

        .value-display {
            font-family: 'Cinzel', serif;
            color: var(--odia-maroon);
            font-weight: 700;
            font-size: 1rem;
            background: var(--odia-cream);
            padding: 2px 10px;
            border-radius: 4px;
        }

        .btn-generate {
            width: 100%;
            padding: 20px;
            margin-top: 30px;
            background: linear-gradient(135deg, var(--odia-maroon), #500000);
            color: var(--white);
            border: none;
            border-radius: 14px;
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 25px -5px rgba(106, 4, 15, 0.4);
        }
        
        .btn-generate::after {
            content: "";
            position: absolute;
            top: 0; left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }

        .btn-generate:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px -5px rgba(106, 4, 15, 0.5);
        }
        
        .btn-generate:hover::after { left: 100%; }
        
        .btn-generate:active { transform: translateY(-1px); }
        .btn-generate:disabled { opacity: 0.7; cursor: wait; transform: none; }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

        .error-message {
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 25px;
            font-size: 0.9rem;
            font-weight: 500;
            display: none;
            animation: slideUp 0.3s ease-out;
            background: #FFF2F2;
            color: #D90429;
            border: 1px solid #FFCDD2;
            border-left: 4px solid #D90429;
        }

        @media (max-width: 900px) {
            .container { flex-direction: column; max-width: 600px; }
            .sidebar { width: 100%; padding: 40px 30px; min-height: 300px; justify-content: center; }
            .chakra-container { left: 50%; top: 50%; transform: translate(-50%, -50%); opacity: 0.3; width: 400px; height: 400px; }
            .form-section { width: 100%; padding: 40px 30px; max-height: none; }
            .flex-row { flex-direction: column; gap: 20px; }
            h1 { font-size: 2.8rem; }
        }
    </style>
</head>
<body>

    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Consulting the Temple Archives...</div>
        <div class="loading-subtext">Calculating best routes, checking availability, and crafting your journey.</div>
    </div>

    <div class="container">
        
        <div class="sidebar">
            <div class="chakra-container">
                <svg class="chakra-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="100" cy="100" r="95" stroke-width="2"/>
                    <circle cx="100" cy="100" r="88" stroke-width="4"/>
                    <circle cx="100" cy="100" r="80" stroke-width="1" stroke-dasharray="2 2"/>
                    <circle cx="100" cy="100" r="15" fill="var(--odia-gold)" fill-opacity="0.3"/>
                    <circle cx="100" cy="100" r="22" stroke-width="3"/>
                    <g stroke-width="5" stroke-linecap="butt">
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(0, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(45, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(90, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(135, 100, 100)" />
                    </g>
                    <g stroke-width="2">
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(22.5, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(67.5, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(112.5, 100, 100)" />
                        <line x1="100" y1="22" x2="100" y2="178" transform="rotate(157.5, 100, 100)" />
                    </g>
                    <g fill="var(--odia-gold)">
                        <circle cx="100" cy="5" r="3" />
                        <circle cx="100" cy="195" r="3" />
                        <circle cx="5" cy="100" r="3" />
                        <circle cx="195" cy="100" r="3" />
                    </g>
                </svg>
            </div>

            <div class="brand-content">
                <h1>CHAKADOLA</h1>
                <div class="odia-script">‡¨ö‡¨ï‡¨æ‡¨°‡≠ã‡¨≥‡¨æ ‡¨Ø‡¨æ‡¨§‡≠ç‡¨∞‡¨æ</div>
                <div class="decorative-line"></div>
                <p style="letter-spacing: 3px; font-size: 0.75rem; text-transform: uppercase; font-weight: 500; color: var(--odia-sand);">Divine Odisha Journeys</p>
            </div>
            
            <div class="brand-content quote">
                "From the architecture of Konark to the spirituality of Puri."
            </div>
        </div>

        <div class="form-section">
            <h2>Plan Your Sacred Journey</h2>

            <div class="form-group">
                <label>
                    Total Group Size
                    <span id="people-val" class="value-display">2 People</span>
                </label>
                <input id="people-range" type="range" min="1" max="20" value="2" oninput="updateTotalPeople()">
            </div>

            <div class="form-group flex-row">
                <div class="col">
                    <label>Seniors (60+)</label>
                    <div class="counter-box">
                        <input id="senior-count" type="number" min="0" value="0" placeholder="0">
                    </div>
                </div>
                <div class="col">
                    <label>Children (<12)</label>
                    <div class="counter-box">
                        <input id="child-count" type="number" min="0" value="0" placeholder="0">
                    </div>
                </div>
                <div class="col">
                    <label>Specially Abled</label>
                    <div class="counter-box">
                        <input id="abled-count" type="number" min="0" value="0" placeholder="0">
                    </div>
                </div>
            </div>

            <div class="form-group flex-row">
                <div class="col">
                    <label>Duration (Days)</label>
                    <input id="duration" type="number" min="1" value="3">
                </div>
                <div class="col">
                    <label>Start Date</label>
                    <input id="start-date" type="date">
                </div>
            </div>

            <div class="form-group">
                <label>
                    Estimated Budget
                    <span id="budget-val" class="value-display">‚Çπ15,000</span>
                </label>
                <input id="budget-range" type="range" min="5000" max="200000" step="1000" value="15000" oninput="updateBudget()">
            </div>

            <div class="form-group">
                <label>Vibe of the Trip</label>
                <div class="chip-container" id="vibe-container">
                    <div class="chip active">Spiritual / Jagannath</div>
                    <div class="chip">Nature / Eco</div>
                    <div class="chip">Beach Relax</div>
                    <div class="chip">Heritage / Arts</div>
                    <div class="chip">Tribal / Rural</div>
                    <div class="chip">Food Tour</div>
                </div>
            </div>

            <div class="form-group">
                <label>
                    Places to Include (Mandatory)
                    <span class="required-star">*</span>
                </label>
                <div class="tag-container" id="tag-container">
                    <input type="text" id="tag-input" class="tag-input" placeholder="Type places (e.g. Konark, Chilika)...">
                    <div class="suggestions-list" id="suggestions"></div>
                </div>
            </div>

            <div class="form-group">
                <label>Additional Preferences</label>
                <textarea id="preferences" rows="2" placeholder="Eg: Pure Veg Food, Wheelchair accessibility..."></textarea>
            </div>

            <button class="btn-generate" id="submit-btn">‚ú® Create Itinerary</button>
            
            <div class="error-message" id="error-message"></div>
        </div>
    </div>

    <script>
        document.getElementById('start-date').valueAsDate = new Date();

        // --- DATA for Autocomplete ---
        const placesList = [
            "Saila Srikhetra", "Budhi Thakurani Temple", "Talcher Palace", "Sleeping Vishnu", "Satkosia Gorge", 
            "Gharial Research Centre", "Binikei Temple", "Deulajhari", "Malyagiri Hill", "Khuludi Waterfall",
            "Sailashree Palace", "Bhima Dunguri", "Kumuda Pahada", "Siva Temple", "Pataneswari Temple",
            "Somalai Temple", "Chausath Yogini Temple", "Indralath Temple", "Harishankar Temple", "Waterfall",
            "Emami Jagannath Temple", "Fakir Mohan Senapati Museum", "Vanishing Beach", "Balaramgadi", "Talasari Beach",
            "Bichitrapur Mangrove", "Khirachora Gopinath Temple", "Gargeswar Temple", "Panchalingeswar", "Nilagiri Palace",
            "Maa Samaleswari Temple", "Hatapadia", "Nrusinghanath Temple", "Chal Dhar Waterfall", "Gangadhar Meher Memorial",
            "Weaver's Colony", "Rice Bowl Monuments", "Local Market", "Debrigarh Wildlife Sanctuary", "Eco-Tourism Cottages",
            "Bhadrakali Temple", "Eram", "Akhandalamani Temple", "River Ghat", "Dhamarai Temple", "Dhamra Port",
            "River Jetty", "British Era Buildings", "Jagannath Temple", "Muslim Shrines", "Rameswar Temple",
            "Giant Buddha Statue", "Bhairabi Temple", "Mahanadi View", "Jogindra Villa Palace", "Tel-Mahanadi Confluence",
            "Chari Sambhu", "Rural Market", "Sarasara", "Hanuman Temple", "Barabati Fort", "Maritime Museum",
            "Choudwar Fort Ruins", "Bhattarika Temple", "Charchika Temple", "Ansupa Lake", "Dhabaleswar Temple",
            "Mahanadi View Point", "Madhabananda Temple", "Sobhaneswar Temple", "Pradhanpat Waterfall", "Basanta Niwas",
            "Gohira Dam", "Local Forest", "Brahmani River View", "Roadside Amenities", "Kailash Palace", "Nature Camp",
            "Rural Scenery", "Village Temple", "Kapilash Temple", "Saptasajya", "Mahima Gadi", "Dhuni Mandir",
            "Ramial Dam", "Dadhibaman Temple", "Bullock Festival Ground", "Brass Metal Workshops", "Anantasayi Vishnu",
            "River Bank", "Gajapati Palace", "B.N. Palace", "Jirang Monastery", "Tibetan Settlement", "Hill View",
            "Tribal Market", "Mahendragiri Peak", "Pandava Temples", "Gandahati Waterfall", "Nature Camp", "Budhi Thakurani Temple",
            "Silk City Market", "Gopalpur Beach", "Old Lighthouse", "Tara Tarini Temple", "Rushikulya River Bank",
            "Chilika Lake (South)", "Narayani Temple", "Hot Sulphur Spring", "Deer Park", "Jagannath Temple",
            "District Park", "Paradeep Port", "Sea Beach", "Sarala Temple", "Cultural Centre", "Gorakhnath Temple",
            "Picnic Grove", "Gada Kujanga", "Rural Scenery", "Biraja Temple", "Dasaswamedha Ghat", "Mahavinayak Temple",
            "Chandi Temple", "Buddhist Monastery", "ASI Museum", "Industrial Hub", "Market Area", "Buddhist Stupa",
            "Step Well", "Pahadi Mandir", "Jhadeswar Temple", "Koilighugar Waterfall", "Park Area", "Mines View",
            "Temple Complex", "Fort Ruins", "River Bank", "Power Plant View", "Reservoir", "Manikeswari Temple",
            "Palace", "Karlapat Wildlife Sanctuary", "Phurlijharan", "Lankeswari Temple", "Fort Area", "Dokarichanchara",
            "Gudahandi", "Indravati Dam", "View Point", "Putudi Waterfall", "Jagannath Temple", "Hill View Park",
            "Coffee Plantations", "Patali Srikhetra", "Church", "Nature Camp", "Elephant Reserve", "Birupakshya Temple",
            "Forest Area", "Baladevjew Temple", "Kendrapara Canal", "Bhitarkanika Gateway", "Crocodile Breeding Centre",
            "Pentha Beach", "Geo-Tube Sea Wall", "Aul Palace", "Lakshmi Varaha Temple", "Hukitola Building", "Island View",
            "Sanaghagara", "Badaghagara", "Tarini Temple", "Forest Drive", "Murga Mahadev", "Industrial Area",
            "Khandadhar Falls", "Nature Trek", "Fresco Paintings", "Rock Formations", "Lingaraj Temple", "Udayagiri & Khandagiri Caves",
            "Barunei Hill", "Railway Settlement", "Bhagabati Temple", "Dakhina Kali Temple", "Wetland Bird Sanctuary",
            "Watch Tower Point", "Hot Spring", "Hatakeswar Temple", "Sabara Srikhetra", "Tribal Museum", "Jeypore Palace",
            "Jagannath Sagar", "HAL Museum", "Deer Park", "Gupteswar Cave Temple", "River Side", "Deomali Peak",
            "View Points", "Satiguda Dam", "Bhairavi Temple", "Balimela Dam", "Park", "Gurupriya Bridge", "Reservoir View",
            "Mugabindu", "Confluence", "Ammakunda Waterfall", "Temple", "Jagannath Temple", "Similipal Gateway",
            "Barehipani Falls", "Joranda Falls", "Kichakeswari Temple", "Museum", "Devkund Waterfall", "Ambika Temple",
            "Aranya Nivas", "River Bed", "Bhandaragharani Temple", "Hirli Dongri", "Podagad", "Maa Pendrani Temple",
            "Waterfall", "Forest Trek", "Sahid Stambha", "Deer Park", "Indravati Reservoir", "Dam View", "Ladubaba Temple",
            "Raghunath Jew Temple", "Nilamadhav Temple", "Mahanadi River", "Kuanria Dam", "Satkosia Entry", "Raghunath Temple",
            "Market", "Maninag Hill", "Jagannath Temple", "Patora Dam", "Yogeswar Temple", "Dadhibaman Temple", "Raja's Palace",
            "Chura Pahar", "Rural Area", "Sunabeda Wildlife Sanctuary", "Waterfalls", "Budhikomna Temple", "Market",
            "Jagannath Temple", "Golden Beach", "Sun Temple", "Chandrabhaga Beach", "Applique Craft Market", "Maa Barabhuji Temple",
            "Heritage Art Village", "Gotipua Dance Academy", "Dolphin Point", "Sea Mouth Island", "Majhighariani Temple",
            "Hanging Bridge", "Bhimpur", "Vamsadhara River", "Chatikona Falls", "Dongria Kondh Market", "Maa Markama Temple",
            "Niyamgiri Hills", "Waterfall", "Picnic Spot", "Samaleswari Temple", "Ghanteswari Temple", "Hirakud Dam",
            "Gandhi Minar", "Power Channel", "University Area", "Leaning Temple", "Mahanadi Fish", "Gudguda Waterfall",
            "Tribal Market", "Subarnameru Temple", "Mahanadi Ghat", "Papakshay Ghat", "Kapileswar", "Pataneswari",
            "Metakani Temple", "Patali Srikhetra", "Trekking Path", "Weaver's Village", "Market", "Hanuman Vatika",
            "Steel Plant View", "District Museum", "Samaleswari Temple", "Vedavyas Temple", "Cave", "Mandira Dam",
            "Picnic Spot", "Khandadhar (Sundargarh side)", "Boneswar Temple"
        ];

        // --- Tag Input Logic ---
        const tagContainer = document.getElementById('tag-container');
        const tagInput = document.getElementById('tag-input');
        const suggestionsBox = document.getElementById('suggestions');
        let selectedTags = [];

        function createTag(label) {
            const div = document.createElement('div');
            div.className = 'selected-tag';
            div.innerHTML = `${label} <span class="tag-close" onclick="removeTag(this, '${label}')">&times;</span>`;
            tagContainer.insertBefore(div, tagInput);
            selectedTags.push(label);
            tagInput.value = '';
            suggestionsBox.style.display = 'none';
        }

        window.removeTag = function(element, label) {
            tagContainer.removeChild(element.parentElement);
            selectedTags = selectedTags.filter(t => t !== label);
        }

        tagInput.addEventListener('input', function() {
            const val = this.value.toLowerCase();
            suggestionsBox.innerHTML = '';
            if (!val) {
                suggestionsBox.style.display = 'none';
                return;
            }
            const matches = placesList.filter(p => p.toLowerCase().includes(val) && !selectedTags.includes(p));
            if (matches.length > 0) {
                matches.slice(0, 8).forEach(match => { 
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    const regex = new RegExp(`(${val})`, 'gi');
                    div.innerHTML = match.replace(regex, '<strong>$1</strong>');
                    div.onclick = () => createTag(match);
                    suggestionsBox.appendChild(div);
                });
                suggestionsBox.style.display = 'block';
            } else {
                suggestionsBox.style.display = 'none';
            }
        });

        tagInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const val = this.value.trim();
                if (val && !selectedTags.includes(val)) {
                    createTag(val);
                }
            }
            if (e.key === 'Backspace' && !this.value && selectedTags.length > 0) {
                const lastTag = selectedTags[selectedTags.length - 1];
                const tags = document.querySelectorAll('.selected-tag');
                removeTag(tags[tags.length - 1].querySelector('.tag-close'), lastTag);
            }
        });

        document.addEventListener('click', function(e) {
            if (!tagContainer.contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });

        tagContainer.addEventListener('click', function(e) {
            if (e.target === tagContainer) tagInput.focus();
        });

        function updateTotalPeople() {
            const val = document.getElementById("people-range").value;
            document.getElementById("people-val").innerText = val + " People";
            validateGroupComposition();
        }

        function updateBudget() {
            let val = document.getElementById("budget-range").value;
            let formatted = parseInt(val).toLocaleString("en-IN");
            document.getElementById("budget-val").innerText = "‚Çπ" + formatted;
        }

        document.querySelectorAll('.chip').forEach(chip => {
            chip.addEventListener('click', function() {
                this.classList.toggle('active');
            });
        });

        const API_URL = "http://localhost:8000/itinerary";

        // --- SUBMIT LOGIC WITH REDIRECT FIX ---
        document.getElementById("submit-btn").addEventListener("click", async () => {
            const btn = document.getElementById("submit-btn");
            const errorMsg = document.getElementById("error-message");
            const loadingOverlay = document.getElementById("loading-overlay");
            
            // Clear previous error
            errorMsg.style.display = "none";

            // --- VALIDATION ---
            if (selectedTags.length === 0) {
                errorMsg.textContent = "‚ùå Please specify at least one place to include.";
                errorMsg.style.display = "block";
                tagContainer.style.borderColor = "#D90429";
                tagContainer.style.background = "#FFF5F5";
                return;
            } else {
                tagContainer.style.borderColor = "#EAEAEA";
                tagContainer.style.background = "#FAFAFA";
            }

            const activeVibes = Array.from(document.querySelectorAll(".chip.active"));
            if (activeVibes.length === 0) {
                errorMsg.textContent = "‚ùå Please select at least one trip vibe";
                errorMsg.style.display = "block";
                return;
            }

            const groupSize = parseInt(document.getElementById("people-range").value);
            const seniors = parseInt(document.getElementById("senior-count").value) || 0;
            const children = parseInt(document.getElementById("child-count").value) || 0;
            const abled = parseInt(document.getElementById("abled-count").value) || 0;

            if (seniors + children + abled > groupSize) {
                errorMsg.textContent = "‚ùå Seniors + Children + Specially Abled cannot exceed Total Group Size";
                errorMsg.style.display = "block";
                return;
            }

            // --- 1. SHOW LOADING OVERLAY ---
            loadingOverlay.style.display = "flex";

            try {
                const payload = {
                    group_size: groupSize,
                    seniors: seniors,
                    children: children,
                    specially_abled: abled,
                    duration: parseInt(document.getElementById("duration").value),
                    start_date: document.getElementById("start-date").value,
                    budget: parseInt(document.getElementById("budget-range").value),
                    specific_places: selectedTags.join(", "), 
                    preferences: document.getElementById("preferences").value,
                    vibes: activeVibes.map(c => c.innerText.trim())
                };

                console.log("üì§ Sending payload:", payload);

                // --- 2. FETCH FROM BACKEND ---
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.detail || data.message || "Server error");
                }

                if (data.success) {
                    console.log("‚úÖ Received itinerary:", data.data);
                    
                    // --- 3. SAVE DATA ---
                    localStorage.setItem('chakadola_itinerary', JSON.stringify(data.data));
                    
                    // --- 4. REDIRECT ---
                    window.location.href = "results.html";
                } else {
                    throw new Error(data.message || "Failed to generate itinerary");
                }

            } catch (error) {
                console.error("‚ùå Error:", error);
                
                // --- 5. HIDE LOADER ON ERROR ---
                loadingOverlay.style.display = "none";
                
                errorMsg.textContent = `‚ùå ${error.message || "Could not connect to server."}`;
                errorMsg.style.display = "block";
            }
        });

        // Validation Listeners
        document.getElementById("senior-count").addEventListener("input", validateGroupComposition);
        document.getElementById("child-count").addEventListener("input", validateGroupComposition);
        document.getElementById("abled-count").addEventListener("input", validateGroupComposition);
        document.getElementById("people-range").addEventListener("input", validateGroupComposition);

        function validateGroupComposition() {
            const groupSize = parseInt(document.getElementById("people-range").value);
            const seniors = parseInt(document.getElementById("senior-count").value) || 0;
            const children = parseInt(document.getElementById("child-count").value) || 0;
            const abled = parseInt(document.getElementById("abled-count").value) || 0;
            const errorMsg = document.getElementById("error-message");
            
            if (seniors + children + abled > groupSize) {
                errorMsg.textContent = "‚ö†Ô∏è Warning: Composition exceeds Total Group Size (" + groupSize + ")";
                errorMsg.style.display = "block";
            } else {
                errorMsg.style.display = "none";
            }
        }
    </script>
</body>
</html>